BEGIN:VCALENDAR
VERSION:2.0
CALSCALE:GREGORIAN
PRODID:-//Rockwood Productions//RecordingCalendar//EN
X-WR-CALNAME:RockwoodPro
<% recordings.each do |recording| %>
BEGIN:VEVENT
UID:<%= recording.uid %>
DTSTAMP:<%= l recording.created_at, format: :ical %>
STATUS:CONFIRMED
ORGANIZER;CN=<%= recording.user.full_name %>:MAILTO:<%= recording.user.email %>
DTSTART:<%= l recording.datetime, format: :ical %>
DTEND:<%= l recording.datetime + 1.hour, format: :ical %>
SUMMARY:Recording - <%= recording.user.full_name %>
DESCRIPTION:<%= recording.user.full_name %>\n<%= recording.context %>\n<%= recording.level %>\nCDs - <%= recording.cds %>\nDVDs - <%= recording.dvds %>
LOCATION:<%= recording.location %>
STATUS:<%= recording.state == "confirmed" ? "CONFIRMED" : "TENTATIVE" %>
BEGIN:VALARM
TRIGGER:-PT2H
ACTION:DISPLAY
END:VALARM
END:VEVENT
<% end %>
END:VCALENDAR